<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wongnai</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
            justify-content: space-between;
        }
        body {
            background-color: #f5f5f5;
            text-align: center;
        }
        header {
            display: flex;
            justify-content: space-between; 
            align-items: center;
            padding: 20px;
            background: #ffffff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        #img-wn {
            width: 120px;
            border-radius: 30px;
        }
        #search-bar {
            flex-grow: 1;
            max-width: 80%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 20px;
            width: 100%;
        }
        #search-bar-container {
            display: flex;
            flex-grow: 1;
            justify-content: center;
            align-items: center;
        }
        .top-buttons {
            display: flex;
            gap: 20px;
        }
        .top-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            background-color: #ff9900;
            color: white;
            cursor: pointer;
            font-size: 14px;   
        }
        .search-button{
            margin: 0px;
            border: none;
            background-color: white;
        }
        .categories {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        .categories button {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            background-color: #ffd700;
            color: black;
            font-weight: bold;
            cursor: pointer;
        }
        .recommend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 40px;
            padding: 40px;
        }
        .item {
            background: white;
            padding: 20px;
            border-radius: 20px;
            width: 350px;
            text-align: left;
            position: relative;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .item img {
            width: 100%;
            border-radius: 10px;
        }
        .item h2 {
            font-size: 24px;
            font-weight: bold;
        }
        .item p {
            font-size: 14px;
            color: #666;
            margin: 10px 0;
        }
        .rating {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            color: #ff9900;
            font-weight: bold;
        }
        .explore-button {
            display: inline-block;
            margin-top: 10px;
            padding: 10px 15px;
            background: black;
            color: white;
            border-radius: 20px;
            font-size: 14px;
            text-decoration: none;
        }
        #search-results {
            width: 100%;
            max-width: 400px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-top: 100px;
            padding: 10px;
            display: none; /* ซ่อนผลลัพธ์เริ่มต้น */
            position: absolute;
            z-index: 10;   
        }   
.search-item {
    padding: 5px;
    cursor: pointer;
}
.search-item:hover {
    background-color: #f0f0f0;
}
        .admin-icon {
            width: 30px;
            height: 30px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header>
        <img id="img-wn" src="wongnai001.webp" alt="Wongnai">
        <div id ="search-bar-container">
            <input type="text" id="search-bar" placeholder="Search your food" onkeydown="searchMenu(event)" >
            <button id="search-results" onclick="showmenu()">

            </button>
        </div>
        <div class="top-buttons">
            <img src="noti.png"onclick ="goToPage('notification.html')" src="images.png" width="30" alt="Profile">
            <img id="img-pro" onclick ="goToPage('accpage+cart .html')" src="images.png" width="30" alt="Profile">
            <img src="adminicon.jpg" class="admin-icon" onclick="goToPage('admindecision.html')" alt="Admin" >
            <button  onclick="Logout()">Log out</button>
            <button onclick="goToPage('Addmenu.html')">Make your Recipe</button>
        </div>
    </header>
    
    
    
    <section class="recommend">
        <div class="item">
            <img src="recipes_20-tamagoyaki-japanese-omelette.avif" alt="Japanese Omelet">
            <h2>Recommend</h2>
            <h3>ไข่หวานต้นหอมญี่ปุ่น</h3>
            <div class="rating">⭐ 4.9 | ⏳ 20 mins</div>
            <p>ไข่หวานต้นหอมญี่ปุ่น อัดแน่นไปด้วยแคลเซียมและสารอาหาร...</p>
            <button onclick="get_recomment_1()" class="explore-button">Explore More!</button>
            
        </div>
        
        <div class="item">
            <img src="mango-smoothie.jpg" alt="Mango Coconut Smoothie">
            <h2>Recommend</h2>
            <h3>Mango Coconut Smoothie</h3>
            <div class="rating">⭐ 4.9 | ⏳ 20 mins</div>
            <p>หอมมันชื่นใจสุดๆ กับ Mango Coconut Smoothie ที่ดีต่อสุขภาพ...</p>
            <a onclick="get_recomment_2()" class="explore-button">Explore More!</a>
        </div>
    </section>
    
    <script>
        function goToPage(page) {
            window.location.href = page;
        }
        async function searchMenu(event) {
            if(event.key === 'Enter') {
                try {

                const menu = document.getElementById('search-bar').value.trim(); // Get input value safely

                if (!menu) {
                    console.log("Please enter a menu.");
                    return;
                }

                const response = await fetch(`http://localhost:8000/searchMenu?menu=${menu}`);
                const data = await response.json();

                const resultsDiv = document.getElementById('search-results');

                if (data.menu) {
                    resultsDiv.innerHTML = `<div class="search-item">${data.menu}</div>`;
                    resultsDiv.style.display = "block"; // Show results
                    console.log("Menu found:", data.menu);
                } else {
                    resultsDiv.innerHTML = `<div class="search-item">menu not found</div>`;
                    resultsDiv.style.display = "block"; // Show message
                    console.log("Menu not found",data.menu);
                }
                } 
                catch (error) {
                    console.error("Error fetching user data:", error);
                }
        }
}

    document.addEventListener("click", function(event) {
        let searchBar = document.getElementById('search-bar');
        let searchResults = document.getElementById('search-results');

        // Check if the clicked element is not the search bar or search results
        if (!searchBar.contains(event.target) && !searchResults.contains(event.target)) {
            searchResults.style.display = "none"; // Hide results
        }
    });

    async function showmenu() {
    try {
        const menu = document.getElementById('search-bar').value.trim();

        if (!menu) {
            console.log("Please enter a menu.");
            return;
        }

        const response = await fetch(`http://localhost:8000/showMenu?menu=${menu}`);

        if (!response.ok) {
            throw new Error("Failed to fetch menu");
        }

        const data = await response.json();
        const resultsDiv = document.getElementById('search-results');
        console.log(data.menu)
        if (data.menu ) {
            // เก็บข้อมูลเมนูใน localStorage
            localStorage.setItem('menuData', JSON.stringify(data.menu));
            // ไปยังหน้า showmenu.html
            window.location.href = 'showmenu.html';
            
        } else {
            resultsDiv.innerHTML = `<div class="search-item">Menu not found</div>`;
            resultsDiv.style.display = "block"; // Show message
            console.log("Menu not found:", data.menu);
        }
    } catch (error) {
        console.error("Error fetching user data:", error);
    }
}




    async function Logout() {
    try {
        
        const response = await fetch(`http://localhost:8000/log_out`);
        const data = await response.json();
        if(data.message){
            alert(data.message)
            window.location.href = 'mainpage.html';
        }
        else{
            alert("You already log out")
        }

        
    } catch (error) {
        console.error("Error fetching user data:", error);
    }
}
    function get_recomment_1() {
        
        localStorage.setItem('menuData', JSON.stringify( {
    "_Menu__menu_id": 1,
    "_Menu__name": "ไข่หวานต้มหอมญี่ปุ่น",
    "_Menu__owner": "admin",
    "_Menu__how_to": "ตั้งกระทะเทฟลอนโดยใช้ไฟอ่อน ๆ นำน้ำมันพืชเช็ดให้ทั่วกระทะ พอกระทะร้อน ยกกระทะขึ้นจากเตา จากนั้นตักไข่ใส่ลงไปพอให้ไข่เคลือบเป็นแผ่นบาง ๆ ทั่วกระทะเมื่อไข่เริ่มเซตตัวดีใช้พายปาดขอบด้านข้าง ค่อย ๆ ม้วนไข่หวานจนเกือบสุดขอบกระทะ จากนั้นใช้พายช่วยประคองไข่ม้วน ให้ถอยหลังมาจุดเริ่มต้นเช็ดกระทะด้วยน้ำมันอีกครั้งให้กระทะสะอาด ตักไข่ใส่ลงไป รอไข่เซตตัวแล้วม้วนต่อจนจบ ทำซ้ำจนไข่หมดหรือได้ความหนาตามต้องการเมื่อไข่หวานได้ความหนาตามต้องการแล้ว ตะแคงกระทะไปมาให้ครบทุกด้านเพื่อจัดทรงให้เป็นชิ้นสี่เหลี่ยม และให้เนื้อไข่หวานแน่นดี",
    "_Menu__ingredients": "aro ต้นหอมญี่ปุ่นอินทรีย์ 200 กรัม ไข่ไก่ 6 ฟอง โชยุ 1 ช้อนโต๊ะ  มิริน 1 ช้อนโต๊ะ น้ำตาล 1 ช้อนโต๊ะ น้ำสะอาด 50 กรัม",
    "_Menu__detail": "มาอัปเกรดเมนูไข่หวานให้ดีต่อสุขภาพ กับเมนู “ไข่หวานต้นหอมญี่ปุ่น” ที่แฝงต้นหอมหวานกรอบไว้ในเนื้อไข่ม้วนนุ่มฟู เด็ก ๆ ที่ไม่ชอบกินผักยังเทใจให้เลยค่ะ โดยวันนี้เราเลือกใช้ aro ต้นหอมญี่ปุ่นอินทรีย์ ที่ให้โปรตีนสูง พร้อมอุดมไปด้วยวิตามินและสารอาหารหลากหลายชนิด เป็นการเพิ่มประโยชน์ในมื้ออาหารแบบง่าย ๆ ใคร ๆ ก็ทำเองได้ที่บ้านแน่นอนค่ะ ถ้าทุกคนพร้อมกันแล้ว มาจดสูตรไข่หวานต้นหอมญี่ปุ่นกันเลยดีกว่า! มาอัปเกรดเมนูไข่หวานให้ดีต่อสุขภาพ กับเมนู “ไข่หวานต้นหอมญี่ปุ่น” ที่แฝงต้นหอมหวานกรอบไว้ในเนื้อไข่ม้วนนุ่มฟู เด็ก ๆ ที่ไม่ชอบกินผักยังเทใจให้เลยค่ะ โดยวันนี้เราเลือกใช้ aro ต้นหอมญี่ปุ่นอินทรีย์ ที่ให้โปรตีนสูง พร้อมอุดมไปด้วยวิตามินและสารอาหารหลากหลายชนิด เป็นการเพิ่มประโยชน์ในมื้ออาหารแบบง่าย ๆ ใคร ๆ ก็ทำเองได้ที่บ้านแน่นอนค่ะ ถ้าทุกคนพร้อมกันแล้ว มาจดสูตรไข่หวานต้นหอมญี่ปุ่นกันเลยดีกว่า!  ",
    "_Menu__preparing_time": "10 นาที",
    "_Menu__making_itme": "20 นาที",
    "_Menu__size": "3 คน",
    "_Menu__calories": "260 Kcal/เสิร์ฟ ",
    "_Menu__like": 0,
    "_Menu__comments": [],
    "_Menu__cost": 50,
    "_Menu__checked_by_admin": true
  }));
  
  window.location.href = 'showmenu.html'; 

}
        
function get_recomment_2() {
        
        localStorage.setItem('menuData', JSON.stringify( {
    "_Menu__menu_id": 2,
    "_Menu__name": "Mango Coconut Smoothie ",
    "_Menu__owner": "admin",
    "_Menu__how_to": "ใส่เนื้อมะม่วงแช่แข็ง เนื้อมะพร้าว กะทิ เกลือ น้ำแข็ง ลงในโหลปั่น จากนั้นใส่ ไซรัปSenoritaกลิ่นมะม่วงอกร่องทองแล้วปั่นให้เข้ากัน อ่านต่อได้ที่ทใส่แก้วตามชอบตกแต่งด้วยเนื้อมะม่วงสุก เนื้อมะพร้าว ราดกะทิ ปิดท้ายด้วยสะระแหน่ แค่นี้ก็พร้อมเสิร์ฟแล้ว อ่านต่อได้ที่ ",
    "_Menu__ingredients": "ไซรัป Senorita กลิ่นมะม่วงอกร่องทอง 50 มิลลิลิตร เนื้อมะม่วงแช่แข็ง 300 กรัม เนื้อมะพร้าว 150 กรัม กะทิ 50 มิลลิลิตร เกลือ ½ ช้อนชา สะระแหน่ สำหรับตกแต่ง เนื้อมะม่วงสุก สำหรับตกแต่ง เนื้อมะพร้าว สำหรับตกแต่ง กะทิสำหรับตกแต่ง",
    "_Menu__detail": "ร้อนใจจะขาด ต้องการเครื่องดื่มเย็น ๆ สักแก้วดับกระหายเพิ่มพลังชีวิต! ตอนนี้ใครที่มีอาการเดียวกับน้องหลุมดำ มาค่ะมา! จะพาเข้าครัวไปทำน้ำปั่นกัน ร้อน ๆ แบบนี้จัดไปกับ “Mango Coconut Smoothie” มะม่วงสมูทตี้เนื้อเนียน หอม หวานกลมกล่อม หอมกลิ่นมะม่วงอกร่องด้วย “ไซรัป Senorita กลิ่นมะม่วงอกร่องทอง” เพิ่มความละมุนด้วยเนื้อมะพร้าวเน้น ๆ พร้อมตกแต่งด้วยเนื้อมะม่วงฉ่ำ ๆ ใครได้ลองก็ต้องขอเบิลแก้วที่สองแน่นอน ถ้าพร้อมแล้วมาจดสูตรค่า",
    "_Menu__preparing_time": "10 นาที",
    "_Menu__making_itme": "20 นาที",
    "_Menu__size": "2 คน",
    "_Menu__calories": "500 Kcal/เสิร์ฟ ",
    "_Menu__like": 0,
    "_Menu__comments": [],
    "_Menu__cost": 50,
    "_Menu__checked_by_admin": true
  }));
  
  window.location.href = 'showmenu.html'; 

}

    </script>
</body>
</html>